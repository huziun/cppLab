<html>
  <!-- To try locally, run: `yarn build` and then `npx http-server -o` -->
  <head>
    <link rel="stylesheet" href="assets/admin.min.css">
    <link rel="stylesheet" href="assets/bootstrap.min.css">
    <link rel="stylesheet" href="assets/style.css">


    <style>
      
    [class*=sidebar-dark-] .nav-sidebar>.nav-item.menu-open>.nav-link, [class*=sidebar-dark-] .nav-sidebar>.nav-item:hover>.nav-link, [class*=sidebar-dark-] .nav-sidebar>.nav-item>.nav-link:focus {
      background-color: #8bf021;
      border-radius: 20px;
      color: black!important;
    }
    .nav-item {
      width:70%;
      
    }
    
    .nav-link-r {
      color: white!important;
      padding-right: 1rem!important;
      padding-left: 1.5rem!important;
    }
    #main {
      margin-left: 250px;
      transition: margin-left .3s ease-in-out;
    }
    .w-70 {
      width: 70%!important;
    }
    .w-100 {
      width: 100%!important;
    }
    .w-100px{
      width:100px!important;
    }
    </style>
    <script src="assets/font.js"></script>

  </head>
  <body class="layout-fixed" style="background-color: #302D2E;">
    <!-- Main Sidebar Container -->
<aside class="main-sidebar sidebar-dark-primary elevation-4 " style="background-color: #4E4E4E;">
  <!-- Brand Logo -->
  
  <a href="index.html" class="brand-link logo-switch mt-5" stye="color: #4e4e4e;">
    <img src="images/logo.png" alt="AdminLTE Docs Logo Large" class="brand-image-xs logo-xl ml-3 mt-3" style="left: 12px">
  </a>
    <!-- Sidebar Menu -->
    <nav class="mt-2 my-auto">
  
        <nav class="mt-2 my-auto">
          <ul class="nav nav-pills nav-sidebar nav-child-indent flex-column justify-content-center mxaaut" data-widget="treeview" role="menu">
  
              <li class="nav-item mx-auto" style=" width:70%!important;">
                <a href="" class="nav-link nav-link-r">
                  <i class="nav-icon fas fa-th"></i>
                  <p>
                    Dashboard
                    <i class="right fas fa-angle-left"></i>
                  </p>
                </a>

                <ul class="nav nav-treeview">
                  <li class="nav-item " style=" width:70%!important;">
                      <a href="#" class="nav-link nav-link-r" onclick="includeHTML('boxx111.html')">
 
                        <p>#Box 1</p>
                      </a>
                    </li><li class="nav-item" style=" width:70%!important;">
                      <a href="#" class="nav-link nav-link-r" onclick="includeHTML('box22.html')">
                  
                        <p>#Box 2</p>
                      </a>
                    </li>
                  </ul>
              </li>

              <li class="nav-item mx-auto" style=" width:70%!important;">
  
                <a href="" class="nav-link nav-link-r">
                  <i class="nav-icon fas fa-cog"></i>
                  <p>
                    Setting
                    <i class="right fas fa-angle-left"></i>
                  </p>
                </a>
    
                <ul class="nav nav-treeview">
                  <li class="nav-item" style=" width:70%!important;">
                      <a href="" class="nav-link nav-link-r">
                     
                        <p>Hipoksja</p>
                      </a>
                    </li><li class="nav-item" style=" width:70%!important;">
                      <a href="" class="nav-link nav-link-r">
                       
                        <p>Hiperoksja</p>
                      </a>
                    </li>
                  </ul>
              </li>

              <li class="nav-item mx-auto" style=" width:70%!important;">
                <a href="" class="nav-link nav-link-r">
                  <i class="nav-icon fas fa-calendar-alt"></i>
                  <p>
                    Calendar
                    
                  </p>
                </a>

              </li>

              <li class="nav-item mx-auto" style=" width:70%!important;">

                <a href="" class="nav-link nav-link-r">
                  <i class="nav-icon fas fa-sign-out-alt"></i>
                  <p>
                    Log out
                    
                  </p>
                </a>
    
                
              </li>

          </ul>
        </nav>
      </div></div></div><div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-unusable os-scrollbar-auto-hidden"><div class="os-scrollbar-track"><div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar os-scrollbar-vertical os-scrollbar-auto-hidden"><div class="os-scrollbar-track"><div class="os-scrollbar-handle" style="height: 32.9353%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar-corner"></div></div>
    </nav>
    <!-- /.sidebar-menu -->
  </div>
  <!-- /.sidebar -->
</aside>
<!-- Navbar -->
<div>
<nav class="main-header navbar navbar-expand navbar-white navbar-light" style="background-color: #302D2E;height:100px;border: none!important;">
  <!-- Left navbar links -->
  <ul class="navbar-nav">
    
    <li class="nav-item w-100">
      <a href="#" class="nav-link nav-link-r d-flex align-items-center"><i class="far fa-user-circle"></i><span class="mb-1" id="userName">&nbsp;John Doe</span></a>
    </li>
    
  </ul>

  

  <!-- Right navbar links -->
  <ul class="navbar-nav ml-auto" style="margin-right: 20px;">
    <!-- Messages Dropdown Menu -->
    <li class="nav-item">
      <a class="nav-link d-flex w-100px nav-link-r" href="#" id="parentDate" style="width: 125px!important;">
        Fri 9 Apr
      </a>
      
    </li>
    <li class="nav-item">
      <a class="nav-link d-flex w-100px align-items-center nav-link-r" href="#" >
        <i class="far fa-clock d-flex" id="parentTime"></i>
        
      </a>
      
    </li>
    <div class="dropdown">
      <a class="btn btn-outline-secondary dropdown-toggle" style="color:white" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
        EN
      </a>
    
      <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        <li><a class="dropdown-item" href="#">PL</a></li>
        
      </ul>
    </div>
  </ul>
</nav>
<!-- /.navbar -->

 <div id="main" style="background-color: #302D2E;" >
  
 </div>
  
    <script src="assets/jquery.min.js"></script>
    <script src="assets/bootstrap.min.js"></script>
    <script src="assets/admin.min.js"></script>
    <script src="assets/scriptd.js"></script>
    <script type="module">
      import {
        getAuth,
        getUser,
        callService,
        subscribeServices,
        createConnection,
        subscribeEntities,
        ERR_HASS_HOST_REQUIRED,
      } from "./dist/index.js";
      var logined;
      (async () => {
       
        let auth;
        logined = auth;
        try {
          auth = await getAuth();
        } catch (err) {
          if (err === ERR_HASS_HOST_REQUIRED) {
            const hassUrl ='http://192.168.1.15:8123';
            if (!hassUrl) return;
            auth = await getAuth({ hassUrl });
          } else {
            alert(`Unknown error: ${err}`);
            return;
          }
        }
        
        const connection = await createConnection({ auth });
        subscribeEntities(connection, (entities) =>
         
          renderEntities(connection, entities)
        );
        subscribeEntities(connection, (entities) =>
         
          window.entityList = entities
        );
        callService(connection,"climate",'set_temperature',{
          entity_id: "climate.study",
          temperature: 50
        }).then(()=>{console.log("called")});
        // Clear url if we have been able to establish a connection
        if (location.search.includes("auth_callback=1")) {
          history.replaceState(null, "", location.pathname);
        }
        subscribeServices(connection, (services) => console.log("New services!", services))
        // To play from the console
        window.auth = auth;
        window.connection = connection;
        getUser(connection).then((user) => {
          console.log("Logged in as", user);
          window.user = user;
        });
      })();
      class ParentLayout {
        setUser(userName){
          $('#userName').text(" "+userName);
        }
        setTime(time){ //stirng
          $('#parentTime').text(" "+time);
        }
        setDate(date){ //string Fri 9 Apr
          $('#parentDate').text(" "+date);
        }
        render(entities){
          this.setTime(entities["sensor.time"]['state'])
          this.setDate(entities['sensor.date']['state'])
        }
      }
      window.parentLayout = new ParentLayout;
      window.renderBox1 = function(){
        let object = window.content.factory(window.entityList);
        object.render();
        
      }      
      function renderEntities(connection, entities) {
        
        window.parentLayout.render(entities)
        getUser(connection).then((user) => {
          window.parentLayout.setUser(user['name']);
        });
        setTimeout(function(){renderBox1();},50)
        
      }
     
    </script>
    
    <script >
      
      class Box1 {
        constructor(entity){
          this.entities = entity
        }
        render(){
          setTemp(this.entities["climate.study"]['attributes']["temperature"])
        }
      }
      class Box2 {
        constructor(entity){
          this.entities = entity
        }
        render(){
          setTemp(this.entities["climate.study"]['attributes']["temperature"])
        }
      }
      class Box1Factory {
        factory(entity){
          return new Box1(entity);
        }
      }
      class Box2Factory {
        factory(entity){
          return new Box2(entity)
        }
      }
      var global = 1;
      function includeHTML(file) {
        switch(file){
          case "boxx111.html":
            window.content = new Box1Factory;
          case "box22.html":
           window.content = new Box2Factory;
          default:
            break;
          }
        
        $('#main').empty();
        
        $("#main").load(file)
        if(global>1){
          $('#main').load(file);
        }
        setTimeout(function(){
         
          renderBox1();
          
        },50)
       
        global++;
      }
      $('.arrow').click(function(){
        let element = $('#arrow');
        
        (element.attr('class')=='fas fa-arrow-left') ? element.attr('class','fas fa-arrow-right'):element.attr('class','fas fa-arrow-left');
        let parentLayout = $('.layout-fixed');
        
          if(parentLayout.attr('class')=='layout-fixed'){
            parentLayout.attr('class','layout-fixed sidebar-collapse')
            $('#main').css({"margin-left":"0px"});
            $('.bar').css({'left':'15px'})
          }
         else{
          parentLayout.attr('class', 'layout-fixed');
          $('#main').css({"margin-left":"250px"});
          
          $('.bar').css({'left':'0'})
        }

       
        
      })
    </script>
    
  </body>
</html>
